/*! JSON v3.2.4 | http://bestiejs.github.com/json3 | Copyright 2012, Kit Cambridge | http://kit.mit-license.org */
(function(){var y={}.toString,b,s,d;var x=typeof define==="function"&&define.amd,e=!x&&typeof exports=="object"&&exports;if(e||x){if(typeof JSON=="object"&&JSON){if(x){e=JSON}else{e.stringify=JSON.stringify;e.parse=JSON.parse}}else{if(x){e=this.JSON={}}}}else{e=this.JSON||(this.JSON={})}var o,l,v,q;var w,i,f,p,u,t,k,n,m;var a=new Date(-3509827334573292),r,h,g;try{a=a.getUTCFullYear()==-109252&&a.getUTCMonth()===0&&a.getUTCDate()==1&&a.getUTCHours()==10&&a.getUTCMinutes()==37&&a.getUTCSeconds()==6&&a.getUTCMilliseconds()==708}catch(j){}function c(z){var F,C,D,E='{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',B=z=="json";if(B||z=="json-stringify"||z=="json-parse"){if(z=="json-stringify"||B){if((F=typeof e.stringify=="function"&&a)){(D=function(){return 1}).toJSON=D;try{F=e.stringify(0)==="0"&&e.stringify(new Number())==="0"&&e.stringify(new String())=='""'&&e.stringify(y)===d&&e.stringify(d)===d&&e.stringify()===d&&e.stringify(D)==="1"&&e.stringify([D])=="[1]"&&e.stringify([d])=="[null]"&&e.stringify(null)=="null"&&e.stringify([d,y,null])=="[null,null,null]"&&e.stringify({A:[D,true,false,null,"\0\b\n\f\r\t"]})==E&&e.stringify(null,D)==="1"&&e.stringify([1,2],null,1)=="[\n 1,\n 2\n]"&&e.stringify(new Date(-8640000000000000))=='"-271821-04-20T00:00:00.000Z"'&&e.stringify(new Date(8640000000000000))=='"+275760-09-13T00:00:00.000Z"'&&e.stringify(new Date(-62198755200000))=='"-000001-01-01T00:00:00.000Z"'&&e.stringify(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(A){F=false}}if(!B){return F}}if(z=="json-parse"||B){if(typeof e.parse=="function"){try{if(e.parse("0")===0&&!e.parse(false)){D=e.parse(E);if((C=D.A.length==5&&D.A[0]==1)){try{C=!e.parse('"\t"')}catch(A){}if(C){try{C=e.parse("01")!=1}catch(A){}}}}}catch(A){C=false}}if(!B){return C}}return F&&C}}if(!c("json")){if(!a){r=Math.floor;h=[0,31,59,90,120,151,181,212,243,273,304,334];g=function(z,A){return h[A]+365*(z-1970)+r((z-1969+(A=+(A>1)))/4)-r((z-1901+A)/100)+r((z-1601+A)/400)}}if(!(b={}.hasOwnProperty)){b=function(B){var z={},A;if((z.__proto__=null,z.__proto__={toString:1},z).toString!=y){b=function(E){var D=this.__proto__,C=E in (this.__proto__=null,this);this.__proto__=D;return C}}else{A=z.constructor;b=function(D){var C=(this.constructor||A).prototype;return D in this&&!(D in C&&this[D]===C[D])}}z=null;return b.call(this,B)}}s=function(B,F){var C=0,z,A,D,E;(z=function(){this.valueOf=0}).prototype.valueOf=0;A=new z();for(D in A){if(b.call(A,D)){C++}}z=A=null;if(!C){A=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];E=function(G,K){var J=y.call(G)=="[object Function]",I,H;for(I in G){if(!(J&&I=="prototype")&&b.call(G,I)){K(I)}}for(H=A.length;I=A[--H];b.call(G,I)&&K(I)){}}}else{if(C==2){E=function(H,K){var G={},J=y.call(H)=="[object Function]",I;for(I in H){if(!(J&&I=="prototype")&&!b.call(G,I)&&(G[I]=1)&&b.call(H,I)){K(I)}}}}else{E=function(H,K){var J=y.call(H)=="[object Function]",I,G;for(I in H){if(!(J&&I=="prototype")&&b.call(H,I)&&!(G=I==="constructor")){K(I)}}if(G||b.call(H,(I="constructor"))){K(I)}}}}return E(B,F)};if(!c("json-stringify")){o={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};l=function(z,A){return("000000"+(A||0)).slice(-z)};v=function(C){var z='"',A=0,B;for(;B=C.charAt(A);A++){z+='\\"\b\f\n\r\t'.indexOf(B)>-1?o[B]:(o[B]=B<" "?"\\u00"+l(2,B.charCodeAt(0).toString(16)):B)}return z+'"'};q=function(F,W,D,I,T,z,G){var P=W[F],B,L,V,U,H,S,Q,M,J,O,A,E,C,R,N,K;if(typeof P=="object"&&P){B=y.call(P);if(B=="[object Date]"&&!b.call(P,"toJSON")){if(P>-1/0&&P<1/0){if(g){U=r(P/86400000);for(L=r(U/365.2425)+1970-1;g(L+1,0)<=U;L++){}for(V=r((U-g(L,0))/30.42);g(L,V+1)<=U;V++){}U=1+U-g(L,V);H=(P%86400000+86400000)%86400000;S=r(H/3600000)%24;Q=r(H/60000)%60;M=r(H/1000)%60;J=H%1000}else{L=P.getUTCFullYear();V=P.getUTCMonth();U=P.getUTCDate();S=P.getUTCHours();Q=P.getUTCMinutes();M=P.getUTCSeconds();J=P.getUTCMilliseconds()}P=(L<=0||L>=10000?(L<0?"-":"+")+l(6,L<0?-L:L):l(4,L))+"-"+l(2,V+1)+"-"+l(2,U)+"T"+l(2,S)+":"+l(2,Q)+":"+l(2,M)+"."+l(3,J)+"Z"}else{P=null}}else{if(typeof P.toJSON=="function"&&((B!="[object Number]"&&B!="[object String]"&&B!="[object Array]")||b.call(P,"toJSON"))){P=P.toJSON(F)}}}if(D){P=D.call(W,F,P)}if(P===null){return"null"}B=y.call(P);if(B=="[object Boolean]"){return""+P}else{if(B=="[object Number]"){return P>-1/0&&P<1/0?""+P:"null"}else{if(B=="[object String]"){return v(P)}}}if(typeof P=="object"){for(C=G.length;C--;){if(G[C]===P){throw TypeError()}}G.push(P);O=[];R=z;z+=T;if(B=="[object Array]"){for(E=0,C=P.length;E<C;N||(N=true),E++){A=q(E,P,D,I,T,z,G);O.push(A===d?"null":A)}K=N?(T?"[\n"+z+O.join(",\n"+z)+"\n"+R+"]":("["+O.join(",")+"]")):"[]"}else{s(I||P,function(Y){var X=q(Y,P,D,I,T,z,G);if(X!==d){O.push(v(Y)+":"+(T?" ":"")+X)}N||(N=true)});K=N?(T?"{\n"+z+O.join(",\n"+z)+"\n"+R+"}":("{"+O.join(",")+"}")):"{}"}G.pop();return K}};e.stringify=function(z,B,C){var A,H,F,E,D,G;if(typeof B=="function"||typeof B=="object"&&B){if(y.call(B)=="[object Function]"){H=B}else{if(y.call(B)=="[object Array]"){F={};for(E=0,D=B.length;E<D;G=B[E++],((y.call(G)=="[object String]"||y.call(G)=="[object Number]")&&(F[G]=1))){}}}}if(C){if(y.call(C)=="[object Number]"){if((C-=C%1)>0){for(A="",C>10&&(C=10);A.length<C;A+=" "){}}}else{if(y.call(C)=="[object String]"){A=C.length<=10?C:C.slice(0,10)}}}return q("",(G={},G[""]=z,G),H,F,A,"",[])}}if(!c("json-parse")){w=String.fromCharCode;i={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"\t",n:"\n",f:"\f",r:"\r"};f=function(){n=m=null;throw SyntaxError()};p=function(){var F=m,C=F.length,E,D,B,z,A;while(n<C){E=F.charAt(n);if("\t\r\n ".indexOf(E)>-1){n++}else{if("{}[]:,".indexOf(E)>-1){n++;return E}else{if(E=='"'){for(D="@",n++;n<C;){E=F.charAt(n);if(E<" "){f()}else{if(E=="\\"){E=F.charAt(++n);if('\\"/btnfr'.indexOf(E)>-1){D+=i[E];n++}else{if(E=="u"){B=++n;for(z=n+4;n<z;n++){E=F.charAt(n);if(!(E>="0"&&E<="9"||E>="a"&&E<="f"||E>="A"&&E<="F")){f()}}D+=w("0x"+F.slice(B,n))}else{f()}}}else{if(E=='"'){break}D+=E;n++}}}if(F.charAt(n)=='"'){n++;return D}f()}else{B=n;if(E=="-"){A=true;E=F.charAt(++n)}if(E>="0"&&E<="9"){if(E=="0"&&(E=F.charAt(n+1),E>="0"&&E<="9")){f()}A=false;for(;n<C&&(E=F.charAt(n),E>="0"&&E<="9");n++){}if(F.charAt(n)=="."){z=++n;for(;z<C&&(E=F.charAt(z),E>="0"&&E<="9");z++){}if(z==n){f()}n=z}E=F.charAt(n);if(E=="e"||E=="E"){E=F.charAt(++n);if(E=="+"||E=="-"){n++}for(z=n;z<C&&(E=F.charAt(z),E>="0"&&E<="9");z++){}if(z==n){f()}n=z}return +F.slice(B,n)}if(A){f()}if(F.slice(n,n+4)=="true"){n+=4;return true}else{if(F.slice(n,n+5)=="false"){n+=5;return false}else{if(F.slice(n,n+4)=="null"){n+=4;return null}}}f()}}}}return"$"};u=function(C){var A,B,z;if(C=="$"){f()}if(typeof C=="string"){if(C.charAt(0)=="@"){return C.slice(1)}if(C=="["){A=[];for(;;B||(B=true)){C=p();if(C=="]"){break}if(B){if(C==","){C=p();if(C=="]"){f()}}else{f()}}if(C==","){f()}A.push(u(C))}return A}else{if(C=="{"){A={};for(;;B||(B=true)){C=p();if(C=="}"){break}if(B){if(C==","){C=p();if(C=="}"){f()}}else{f()}}if(C==","||typeof C!="string"||C.charAt(0)!="@"||p()!=":"){f()}A[C.slice(1)]=u(p())}return A}}f()}return C};k=function(B,A,C){var z=t(B,A,C);if(z===d){delete B[A]}else{B[A]=z}};t=function(C,B,D){var A=C[B],z;if(typeof A=="object"&&A){if(y.call(A)=="[object Array]"){for(z=A.length;z--;){k(A,z,D)}}else{s(A,function(E){k(A,E,D)})}}return D.call(C,B,A)};e.parse=function(B,C){var z,A;n=0;m=B;z=u(p());if(p()!="$"){f()}n=m=null;return C&&y.call(C)=="[object Function]"?t((A={},A[""]=z,A),"",C):z}}}if(x){define(function(){return e})}}).call(this);
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
if(typeof document!=="undefined"&&!("classList" in document.createElement("a"))){(function(j){if(!("HTMLElement" in j)&&!("Element" in j)){return}var a="classList",f="prototype",m=(j.HTMLElement||j.Element)[f],b=Object,k=String[f].trim||function(){return this.replace(/^\s+|\s+$/g,"")},c=Array[f].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p}}return -1},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p},g=function(p,o){if(o===""){throw new n("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(o)){throw new n("INVALID_CHARACTER_ERR","String contains an invalid character")}return c.call(p,o)},d=function(s){var r=k.call(s.className),q=r?r.split(/\s+/):[],p=0,o=q.length;for(;p<o;p++){this.push(q[p])}this._updateClassName=function(){s.className=this.toString()}},e=d[f]=[],i=function(){return new d(this)};n[f]=Error[f];e.item=function(o){return this[o]||null};e.contains=function(o){o+="";return g(this,o)!==-1};e.add=function(){var s=arguments,r=0,p=s.length,q,o=false;do{q=s[r]+"";if(g(this,q)===-1){this.push(q);o=true}}while(++r<p);if(o){this._updateClassName()}};e.remove=function(){var t=arguments,s=0,p=t.length,r,o=false;do{r=t[s]+"";var q=g(this,r);if(q!==-1){this.splice(q,1);o=true}}while(++s<p);if(o){this._updateClassName()}};e.toggle=function(p,q){p+="";var o=this.contains(p),r=o?q!==true&&"remove":q!==false&&"add";if(r){this[r](p)}return o};e.toString=function(){return this.join(" ")};if(b.defineProperty){var l={get:i,enumerable:true,configurable:true};try{b.defineProperty(m,a,l)}catch(h){if(h.number===-2146823252){l.enumerable=false;b.defineProperty(m,a,l)}}}else{if(b[f].__defineGetter__){m.__defineGetter__(a,i)}}}(self))}if(typeof window.localStorage=="undefined"||typeof window.sessionStorage=="undefined"){(function(){var a=function(f){function e(k,l,m){var j,i;if(m){j=new Date();j.setTime(j.getTime()+(m*24*60*60*1000));i="; expires="+j.toGMTString()}else{i=""}document.cookie=k+"="+l+i+"; path=/"}function h(k){var m=k+"=",j=document.cookie.split(";"),l,n;for(l=0;l<j.length;l++){n=j[l];while(n.charAt(0)==" "){n=n.substring(1,n.length)}if(n.indexOf(m)==0){return n.substring(m.length,n.length)}}return null}function d(i){i=JSON.stringify(i);if(f=="session"){window.name=i}else{e("localStorage",i,365)}}function c(){if(f=="session"){window.name=""}else{e("localStorage","",365)}}function b(){var i=f=="session"?window.name:h("localStorage");return i?JSON.parse(i):{}}var g=b();return{length:0,clear:function(){g={};this.length=0;c()},getItem:function(i){return g[i]===undefined?null:g[i]},key:function(l){var m=0;for(var j in g){if(m==l){return j}else{m++}}return null},removeItem:function(i){delete g[i];this.length--;d(g)},setItem:function(i,j){g[i]=j+"";this.length++;d(g)}}};if(typeof window.localStorage=="undefined"){window.localStorage=new a("local")}if(typeof window.sessionStorage=="undefined"){window.sessionStorage=new a("session")}})()}var Notifier=(function(){var a=document.body;var c={notify:function(d){var b=document.createElement("aside");b.innerHTML=d;b.className="notification";a.appendChild(b);setTimeout(function(){b.className="notification remove"},5000);setTimeout(function(){a.removeChild(b)},6000)}};return c}).call(this);var AddView=(function(){var b={isMobile:true,list:{add:function(){}}};var a=function(m){var h=this,j=null,k=b,f=null,i=null,d=null,l=null;var c=function(n){for(var o in n){if(o==="el"){j=n[o]}else{k[o]=n[o]}}f=document.getElementById("entry-title");i=document.getElementById("entry-content");d=document.getElementById("entry-geolocate");l=document.getElementById("entry-submit");if(!navigator.geolocation){d.checked=false;d.parentNode.style.display="none"}l.addEventListener(k.isMobile?"touchend":"mouseup",h.onViewSubmit)};var g=function(){f.value="";i.value=""};var e=function(n){Notifier.notify(n)};this.onViewSubmit=function(){var r=f.value;var p=i.value;var q=d.checked;var n=+new Date;var o=function(s){m.list.add({title:r,content:p,date:n,location:(s&&s.coords)?s.coords:null});if(q&&(!s||!s.coords)){e("Geolocation failed.")}};if(q){navigator.geolocation.getCurrentPosition(o,o,{enableHighAccuracy:true,timeout:10000})}else{o(null)}g();window.location.hash="#"+Layout.VIEW_LIST};c(m)};return a}).call(this);var List=(function(){var c="entry-",h="delete-",g="diary";CLASS_VISIBLE="visible";CLASS_DELETE="delete";DEFAULTS={clickTimeout:300,swipeYThreshold:20};var b=function(l){if(!l){return""}var m=new Date(l.date),j=f(m),k=a(m),i=d(l.location),n=c+l.date;return['<article id="',n,'">',"<h2>",l.title,'<a href="#',h,c,l.date,'">',"Delete","</a>","</h2>","<h3>",'<time datetime="',j,'">',k,"</time>",i,"</h3>","<p>",l.content.replace(/\n+/g,"</p><p>"),"</p>","</article>"].join("")};var f=function(n){if(n.toISOString){return n.toISOString()}else{var t=n.getUTCFullYear(),j=n.getUTCMonth()+1,r=n.getUTCDate(),q=n.getUTCHours(),o=n.getUTCMinutes(),p=n.getUTCSeconds(),k=String((n.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5);if(j<10){j="0"+j}if(r<10){r="0"+r}if(q<10){q="0"+q}if(o<10){o="0"+o}if(p<10){p="0"+p}return t+"-"+j+"-"+r+"T"+q+":"+o+":"+p+"."+k+"Z"}};var a=function(i){return i.toString()};var d=function(k){var m=null,l="&deg;N",j=null,i="&deg;E";if(k===null){return""}m=parseFloat(k.latitude);j=parseFloat(k.longitude);if(m<0){m*=-1;l="&deg;S"}if(j<0){j*=-1;i="&deg;W"}return m.toFixed(2)+l+", "+j.toFixed(2)+i};var e=function(x){var q=this,w=DEFAULTS,o=[],v=null,l=null,m=null;var k=function(y){var A=null;for(var z in y){if(z==="el"){v=y[z]}else{w[z]=y[z]}}if(v===null){v=document.createElement("section")}A=window.localStorage.getItem(g);if(A){o=JSON.parse(A)}q.render()};var p=function(){var D=v.getElementsByTagName("h2"),A=(w.isMobile)?{touchstart:t,touchend:n,touchcancel:i}:{mousedown:t,mouseup:n};for(var z=0,C=null;C=D[z];z++){for(var B in A){C.addEventListener(B,A[B]);var y=C.getElementsByTagName("a")[0];if(y){y.addEventListener(w.isMobile?"touchend":"mouseup",r)}}}};var r=function(y){var z=new RegExp("^.*#"+h+c);var A=parseInt(this.href.replace(z,""),10);q.remove(q.get(A));if(y.preventDefault){y.preventDefault()}return false};var t=function(y){if(l===null){l={stamp:+new Date,evt:y}}if(y.preventDefault){y.preventDefault()}return false};var n=function(y){m={stamp:+new Date,evt:y};if(l!==null&&(!y.touches||y.touches.length===0)){u(l,m)}l=null;m=null;if(y.preventDefault){y.preventDefault()}return false};var i=function(y){l=null;m=null;if(y.preventDefault){y.preventDefault()}return false};var u=function(B,z){var y=(B.evt.changedTouches)?B.evt.changedTouches[0].clientY:B.evt.clientY;var A=(z.evt.changedTouches)?z.evt.changedTouches[0].clientY:z.evt.clientY;if(z.stamp-B.stamp<=w.clickTimeout){s(z.evt)}else{if(Math.abs(y-A)<=w.swipeYThreshold){j(z.evt)}}};var s=function(y){y.target.parentNode.classList.toggle(CLASS_VISIBLE);y.target.parentNode.classList.remove(CLASS_DELETE)};var j=function(y){y.target.parentNode.classList.toggle(CLASS_DELETE)};this.get=function(A){for(var y=0,z=null;z=o[y];y++){if(z.date===A){return z}}return null};this.add=function(y){o.push(y);this.render()};this.remove=function(B){if(!B){return}var A=B.date;for(var z=0,C=null;C=o[z];z++){var y=C.date;if(y===A){o.splice(z,1);this.render();break}}};this.render=function(){var y=[],z=[];for(var A=0,B=null;B=o[A];A++){y.push(b(B));z.push(B)}y.reverse();if(y.length>0){v.innerHTML=y.join("");p();window.localStorage.setItem(g,JSON.stringify(z))}else{v.innerHTML=['<div class="getstarted">',"Seems like nothing is here yet. Why not try ",'<a href="#add">adding one now</a>?',"</div>"].join("");window.localStorage.removeItem(g)}};k(x)};return e}).call(this);var Layout=(function(){var a="list",d="add",b={initialView:a};var c=function(m){var h=this,l=b,j=[],f=null,g=null,k=null;var e=function(n){for(var o in n){l[o]=n[o]}f=document.body;if("onhashchange" in window){window.addEventListener("hashchange",i)}else{(function(){var p=window.location.hash;k=setInterval(function(){var q=window.location.hash;if(q!==p){i()}},250)}).call(this)}if("onLine" in navigator){window.addEventListener("online",function(){Notifier.notify("You are now online.")});window.addEventListener("offline",function(){Notifier.notify("You are now offline.")});if(navigator.onLine){Notifier.notify("You are currently online.")}else{Notifier.notify("You are currently offline.")}}h.setView(l.initialView);i()};this.__destroy=function(){if("onhashchange" in window){window.removeEventListener("hashchange",i)}else{window.clearInterval(k)}};var i=function(){var n=window.location.hash.replace("#","");if(n===d||n===a){h.setView(n)}};this.setView=function(o){var q=null;if(g===o){return}f.classList.remove((o===a)?d:a);f.classList.add(o);previousView=g;g=o;for(var p=0,n=null;n=j[p];p++){n.callback.call(n.context,g,previousView)}};e(m)};c.VIEW_LIST=a;c.VIEW_ADD=d;return c}).call(this);document.addEventListener("DOMContentLoaded",function(){Notifier.notify("Loaded!");var a=("ontouchstart" in document.createElement("a"));var c=new Layout();var d=new List({el:document.getElementById("entries"),isMobile:a});var b=new AddView({el:document.getElementById("addentry"),isMobile:a,list:d})});